(function(b){b.fn.searchSuggest=function(c){if(typeof c==="string"&&a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}}};var a={init:function(c){var h=function(t){l("url错误或超时，请求失败!")};var l=function(t){console.log(t)};var e=function(x,w,z,y){var v=w.data||w;var t='<div class="content">';for(var u=0;u<v.length;u+=1){t+=y.tpl.replace(/\{([a-z]+)\}/ig,function(A,B){return v[u][B]})}t+='</div><div class="description">'+y.json.defaults+"</div>";k(x,t,z,y)};var p=function(v,u){var v=v||j;var u=u||s;if(!b.trim(v.html())){v.hide();return}var y=v.find(".description");if(u.style==="list"){y.hide();v.find(".content").css({width:"100%",border:"0"});v.find(".content .list .word").css({width:"49%"});v.find(".desc").show();return}else{if(u.style==="line"){y.hide();v.find(".desc").hide();v.find(".content").css({width:"100%",border:"0"});return}}var w=v.find("."+u.listHoverCSS);if(w.length>0){var x=w.find(".word").attr("rel_id").split("_");var t=x[x.length-1];var z=u.json.data[t].description}else{var z=u.json.defaults}y.html(z)};var k=function(u,t,w,v){var w=w||j,v=v||s;w.append(t);p(w,v);w.find(".list").each(function(){b(this).unbind("mouseover").mouseover(function(){o(w,v);b(this).addClass(v.listHoverCSS);p(w,v)}).unbind("click").click(function(){var x;if(v.multiWord){x=u.val().split(" ");x[x.length-1]=d(b(this));u.val(x.join(" "));j.empty().hide()}else{u.val(d(b(this)))}u.focus()})})};var o=function(u,t){var u=u||j,t=t||s;u.find("."+t.listHoverCSS).removeClass(t.listHoverCSS);p(u,t)};var d=function(t){return t.find("div:first").text()};var g=function(w,u,y,x){var A,t,z,v,y=y||j,x=x||s;u=validData=q(u);if(!validData||!u.data.length){y.hide();return false}A=w.offset().left;t=w.height();z=w.offset().top+x.topoffset+t;v=x.width||w.width()+"px";y.empty();y.css({left:A,top:z,width:v});e(w,u,y,x);w.focus();y.fadeIn(500)};var n=function(u,z,B,D,t){var C,x,D=D||j,t=t||s;console.log(t.url+u);if(t.url){var A=t.url.indexOf("?")>-1?"&":"?";var y=t.jsonp?[t.url+u,A,t.jsonp,"=?"].join(""):t.url+u;b.ajax({type:"GET",url:y,dataType:"json",timeout:3000,success:function(E){B(z,E,D,t)},error:h})}else{C=t.json;x=r(C);if(x&&b.trim(u)){var v="{'data':[";for(var w=C.data.length-1;w>=0;w--){if(C.data[w].word.indexOf(u)>-1||u.indexOf(C.data[w].word)>-1){v+="{'id':'"+C.data[w].id+"','word':'"+C.data[w].word+"', 'description': '"+C.data[w].description+"'},"}}v+="],'defaults':'"+C.defaults+"'}";C=(new Function("return "+v))();console.log(C)}B(z,C,D,t)}return};var q=function(t){return validData=r(t)};var r=function(t){var u=!b.isArray(t.data);if(u){l("返回数据格式错误!");return false}if(!t.data.length){l("返回数据为空!");return false}return t};var i=function(u){if(!u){return}var t=document.getElementsByTagName("link");for(var v=t.length-1;v>=0;v--){if(t[v].href.indexOf(u)>-1){return}}var w=document.createElement("link");w.setAttribute("rel","stylesheet");w.setAttribute("type","text/css");w.setAttribute("href",u);document.getElementsByTagName("head")[0].appendChild(w)};var s=b.extend({url:"",jsonp:null,json:{data:[{id:"0",word:"gitnavi.com",description:"http://gitnavi.com"}],defaults:"http://gitnavi.com"},style:"list",cssFile:"",dropDivClassName:"search-suggest",listHoverCSS:"jhover",tpl:'<div class="list"><div class="word" rel_id="st_{id}">{word}</div><div class="desc">{description}</div></div>',multiWord:true,processData:q,getData:n,topoffset:6,keyLeft:37,keyUp:38,keyRight:39,keyDown:40,keyEnter:13},c);s.json.defaults=s.json.defaults||"";if(b.isFunction(s.processData)){q=s.processData}if(b.isFunction(s.getData)){n=s.getData}var m=this.data("searchsuggest");if(m){return this}this.data("searchsuggest",{target:this,options:s});i(s.cssFile);var j=b('<div class="'+s.dropDivClassName+'"></div>').appendTo("body");var f=false;j.hover(function(){f=true},function(){f=false});return this.each(function(){var t=b(this);t.bind("keydown",function(y){if(j.css("display")!=="none"){var x=j.find("."+s.listHoverCSS),u="";if(y.keyCode===s.keyDown){if(!x.length){u=d(j.find(".list:first").mouseover())}else{if(!x.next().length){o(j,s);t.val(t.attr("alt"))}else{o(j,s);if(x.next().length){u=d(x.next().mouseover())}}}}else{if(y.keyCode===s.keyUp){if(!x.length){u=d(j.find(".list:last").mouseover())}else{if(!x.prev().length){o(j,s);t.val(t.attr("alt"))}else{o(j,s);if(x.prev().length){u=d(x.prev().mouseover())}}}}else{if(y.keyCode===s.keyEnter){j.empty().hide()}}}if(u){if(c.multiWord){var w=t.val();var v=w.split(" ");v[v.length-1]=u;t.val(v.join(" "))}else{t.val(u)}return false}}t.attr("alt",b.trim(t.val()))}).bind("keyup",function(u){var v,w;if(u.keyCode===s.keyDown||u.keyCode===s.keyUp){return}v=b.trim(t.val());if(v&&v===t.attr("alt")){return}if(c.multiWord){w=v.split(" ");v=w[w.length-1]}n(b.trim(v),t,g,j,s)}).bind("blur",function(){if(f){return}j.empty().hide()}).bind("click",function(){var u,v;u=t.val();if(b.trim(u)&&u===t.attr("alt")||j.css("display")!=="none"){return}if(c.multiWord){v=u.split(" ");u=v[v.length-1]}n(b.trim(u),t,g,j,s)})})},show:function(){var c=this.data("searchsuggest");if(c&&c.options){b("."+c.options.dropDivClassName).show()}return this},hide:function(){var c=this.data("searchsuggest");if(c&&c.options){b("."+c.options.dropDivClassName).hide()}return this},destroy:function(){var c=this.data("searchsuggest");if(c&&c.options){b("."+c.options.dropDivClassName).remove()}return this.each(function(){b(this).unbind()})}}})(jQuery);